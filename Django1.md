

# Django 웹만들기 (1) 

![image-20200917175428572](C:\Users\mgk04.DESKTOP-8Q51H2D\AppData\Roaming\Typora\typora-user-images\image-20200917175428572.png)



#### MVT 코딩 순서

무엇을 먼저 코딩해야하는지는 정해진 것이 없다. UI 화면을 생각하면서 로직을 풀어나가는 것이 쉬울 때엔 보통 탬플릿을 먼저 코딩한다.

1. 프로젝트 뼈대 만들기 : 프로젝트 및 앱 개발에 필요한 디렉토리와 파일 형성
2. URLconf 코딩하기 : URL 및 뷰 매핑 관계를 정의(urls.py 파일)
3. 뷰 코딩하기 : 어플리케이션 로직 개발(view.py 파일)
4. 템플릿 코딩하기 : 화면 UI 개발(templates/디렉토리 하위의 *.html 파일들)

5. 모델 코딩하기  : 테이블 관련 사항을 개발(models.py,admin.py파일)

---



### 1. 프로젝트 뼈대 만들기 :  

###    - 프로젝트 및 앱 개발에 필요한 디렉토리와 파일 형성

* settings.py 초기 설정

<img src="C:\Users\mgk04.DESKTOP-8Q51H2D\AppData\Roaming\Typora\typora-user-images\image-20200917165033422.png" alt="image-20200917165033422" style="zoom:55%;" />

```
# 프로젝트 생성
> diango-admin startproject djangoWEB
> dir/w
> cd djangoWEB

> dir/w

# App 생성
> python manage.py startapp helloApp
```

```python
"""
Django settings for djangoWEB project.

Generated by 'django-admin startproject' using Django 3.0.3.

For more information on this file, see
https://docs.djangoproject.com/en/3.0/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/3.0/ref/settings/
"""

import os

# Build paths inside the project like this: os.path.join(BASE_DIR, ...)
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/3.0/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 't=_1(@r0qxn42t^fbbt&t*u(xpsje1l1m(&dm4wa7_-4###9vu'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = ['127.0.0.1' , 'localhost']   
                                         # 서버의 ip ['127.0.0.1',localhost] 추가


# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'helloApp',
]                                        # 중요!!  helloApp app등록 !!!

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'djangoWEB.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'djangoWEB.wsgi.application'


# Database
# https://docs.djangoproject.com/en/3.0/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    }
}


# Password validation
# https://docs.djangoproject.com/en/3.0/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/3.0/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'Asia/Seoul'                           #현재 장소'Asia/Seoul'추가

USE_I18N = True

USE_L10N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/3.0/howto/static-files/

STATIC_URL = '/static/'
```



### 2 . URLconf 코딩하기 : 

###  - URL 및 뷰 매핑 관계를 정의(urls.py 파일)

* 클라이언트로 부터 요청에 들어있는 URL이 urls.py파일에 정의된 URL 패턴과 매칭되는지 분석
* urls.py파일에 URL과 퍼리함수 (뷰)를 매핑한다 -> URL/뷰 매핑을 URLconf라고 한다.
* helloApp.urls와 연계 시키는 작업으로 별칭을 hello라고 지정하였다. 

```python
[djangoWEB\urls.py]

"""djangoWEB URL Configuration

The `urlpatterns` list routes URLs to views. For more information please see:
    https://docs.djangoproject.com/en/3.0/topics/http/urls/
Examples:
Function views
    1. Add an import:  from my_app import views
    2. Add a URL to urlpatterns:  path('', views.home, name='home')
Class-based views
    1. Add an import:  from other_app.views import Home
    2. Add a URL to urlpatterns:  path('', Home.as_view(), name='home')
Including another URLconf
    1. Import the include() function: from django.urls import include, path
    2. Add a URL to urlpatterns:  path('blog/', include('blog.urls'))
"""
from django.contrib import admin
from django.urls import path,include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('hello/', include('helloApp.urls'))
]
```

사용자의 request가 hello로 들어오면 이 'helloApp.urls'를 찾을 것이다.

```python
[helloApp\urls.py]

from django.contrib import admin
from django.urls import path,include
from helloApp import views

urlpatterns = [
    path('index/', views.index),
    path('hi/', views.hi),
    path('login/', views.login, name = 'login'),
]
```





###  3. 뷰 코딩하기 : 

###      어플리케이션 로직 개발(view.py 파일)

* 뷰는 웹 요청을 받아서 데이터 베이스 등 해당 어플리케이션의 로직에 맞는 처리를 하고, 그 결과 데이터를 HTML로 변환하기 위하여 템플릿 처리를 한 후에 최종 HTML로 된 응답 데이터를 웹 클라이언트로 반환하는 역할을 한다.
* 장고에서 뷰는 함수 또는 클래스의 메소드로 불리며, 웹 요청을 받고 응답을 반환해준다. 다양한 형태의 응답 데이터를 만들어 내기 위한 로직을 뷰에 작성하는 것인데. 이러한 뷰는 보통 views.py 파일에 작성한다.
* view에 index, hi, login이라는 함수를 생성했다!!!

```python
from django.shortcuts import render, HttpResponse
from .models import *

# Create your views here.

def index(request) :
    #return HttpResponse('<div align=center>섭이와 함께하는 Django WEB Framework</div>')
    return render(request, 'hello/index.html')

def hi(request) :
    context = {'ment' : '여기까지 잘 되시나요? 쉬는 시간 가질까요? ^*^'}
    return render(request, 'hello/okay.html', context)

def login(request) :
    if request.method == 'POST' :
        id = request.POST['id']
        pwd = request.POST['pwd']

        # select * from testUser where id=id; 같은 의미임.
        user = TestUser.objects.get(user_id = id)
        #
        context = {}
        if user is not None :
            print(user.user_id, user.user_pwd, user.user_name)
            context['user'] = user  #객체를 담을 수 있음
        return render(request, 'hello/success.html', context)
```

```
#Server 실행하는 명령어
> python manage.py runserver
```





### 4.  템플릿 코딩하기 : 

###     화면 UI 개발(templates/디렉토리 하위의 *.html 파일들)

* 장고가 클라이언트에 반환하는 최종 응답은 HTML 텍스트이다. 개발자가 응답에 사용할 *.html 파일을 작성하면, 장고는 이를 해석해서 최종 HTML 텍스트 응답을 생성하고, 이를 클라이언트에게 보내준다.
* 템플릿 파일은 *.html 확장자를 가지며, 장고의 템플릿 시스템 문법에 맞게 작성한다. 유의할 점은 템플릿 파일을 적절한 디렉토리에 위치시켜야 한다는 점이다. 즉, 장고에서 템플릿 파일을 찾는 방식을 이해하고 있어야하며, 장고는 그에 맞는 위치에 템플릿 파일이 위치해야 템플릿 파일을 찾을 수 있다

---

templates

- html (tag + text)
- {{print}}
- {% 동적 코드를 작성하고자 할 때 %}
- {% 프리젠테이션 레이어에 로직을 심을 수 있다 %}

```python
[templates->hello->index.html]

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <center>NAVER</center>
    <div align="right">
        <form method="post" action="{% url 'login' %}">

            {% csrf_token %}

            <label>아이디</label> <input type="text" name="id" />
            <label>패스워드</label> <input type="password" name="pwd" />
            <input type ='submit' value="LOGIN">
        </form>
    </div>

</body>
</html>
```

```python
[templates->hello->ok.html]

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <center><font color = "pink"> {{ment}}</font></center>
</body>
```

```python
[templates->hello->success.html]

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    {{user.user_id}}이고 {{user.user_pwd}} 이고 {{user.user_name}} 입니다~~
</body>
</html>
```



### 5. 모델 코딩하기  : 

###    테이블 관련 사항을 개발(models.py,admin.py파일)

```python
[templates -> models.py]

from django.db import models

# Create your models here.

class TestUser(models.Model):
    user_id = models.CharField(max_length=50)
    user_pwd = models.CharField(max_length=50)
    user_name = models.CharField(max_length=50)    
```

```python
[helloAppp->admin.py]  

from django.contrib import admin
from .models import *
# Register your models here.
admin.site.register(TestUser)
```

---

```
# -model(ORM)
# 모델  마이크레시연
# 사용자 모델 -> 디비(테이블) 만드는 명령어
python manage.py makemigrations -> 테이블 만드는것 
python manage.py migrate  -> DB에 들어가서 테이블이 만들어졌는지등을 확인할때 계정이 만들어졌는지 확인
python manage.py createsuperuser
```

### server 실행

```
> python manage.py runserver
```



http://localhost:8000/admin/

![image-20200917174838725](C:\Users\mgk04.DESKTOP-8Q51H2D\AppData\Roaming\Typora\typora-user-images\image-20200917174838725.png)

http://localhost:8000/hello/index/

![](C:\Users\mgk04.DESKTOP-8Q51H2D\AppData\Roaming\Typora\typora-user-images\image-20200917174930655.png)



![image-20200917175026133](C:\Users\mgk04.DESKTOP-8Q51H2D\AppData\Roaming\Typora\typora-user-images\image-20200917175026133.png)

